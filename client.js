const us=Object.fromEntries(["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"].map(e=>[e,1])),ca=Object.fromEntries(["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Northwest Territories","Nova Scotia","Nunavut","Ontario","Prince Edward Island","Quebec","Saskatchewan","Yukon"].map(e=>[e,1])),audienceSynonyms=(meetings.find(e=>"https://meetings.smartrecovery.org/meetings/7360/"==e.href).audience=["Adults Welcome"],{LGBT:"LGBTQIA+","LGBTIQ+ only":"LGBTQIA+","Men only":"Men","Women Only":"Women","Female only":"Women"});function flag(e,a){let n=[e];"na"==e?(a=a.replace(/.*, /,""),n=us[a]?["us"]:ca[a]?["ca"]:["us","ca"]):"aus"==e?n=["au"]:"uk"==e&&(n=["gb"]);const t={us:"USA",ca:"Canada",uk:"UK",au:"Australia"},i=document.createElement("div");return i.className="flagwrapper",n.forEach(e=>{var a=document.createElement("img");a.src=`img/${e}.svg`,a.alt=t[e],a.height=32,a.width=32,a.className="flag",i.appendChild(a)}),i}function partsToDiv(e){const n=document.createElement("div");return e.forEach(e=>{var a;"literal"==e.type?n.append(e.value):((a=document.createElement("span")).className=e.type.replace(/([A-Z])/,e=>"-"+e.toLowerCase()),a.append(e.value),n.appendChild(a))}),n}function render(){var a=document.createElement("table");const n=document.createElement("tr");["Country","Time","Details","Location","Facilitator"].forEach(e=>{var a=document.createElement("th");a.append(e),n.appendChild(a)}),a.appendChild(n);var t=Intl.DateTimeFormat(void 0,{timeStyle:"short"}),i=Intl.DateTimeFormat(void 0,{weekday:"long",month:"long",day:"numeric"});const o=document.getElementById("program").value,d=document.getElementById("audience").value,r=document.getElementById("language").value,l=parseInt(document.getElementById("facilitator").value),c=document.getElementById("includehybrid").checked;var m=meetings.filter(e=>(!o||e.program==o||"4-Point Recovery"==o&&("SMART Recovery"==e.program||"Standard"==e.program))&&(!d||e.audience.map(e=>audienceSynonyms[e]||e).includes(d))&&(!r||e.language==r)&&(!l||(e.facilitator||[]).includes(l))&&(c||"Online"==e.type)).sort((e,a)=>e.time.localeCompare(a.time)),e=[],e=(o&&e.push("program="+encodeURIComponent(o)),d&&e.push("audience="+encodeURIComponent(d)),r&&e.push("language="+encodeURIComponent(r)),c&&e.push("includehybrid=1"),"?"+e.join("&"));history.replaceState(null,"",e);for(let e of m){var p=new Date(e.time),s=new Date(p.getTime()+6e4*e.duration);if(!(s<new Date)){var u=document.createElement("tr"),h=document.createElement("td"),h=(h.appendChild(flag(e.dataSource,e.location)),u.appendChild(h),document.createElement("td")),g=document.createElement("div"),E=partsToDiv(t.formatToParts(p)),E=(E.className="time start",g.appendChild(E),partsToDiv(t.formatToParts(s))),s=(E.className="time end",g.append(" - "),g.appendChild(E),(60<=e.duration?Math.floor(e.duration/60+1e-8)+"h":"")+("0"+e.duration%60).slice(-2)),E=document.createElement("div"),s=(E.className="duration",E.append(s),g.appendChild(E),h.appendChild(g),i.formatToParts(p)),E=(" "==s[3].value&&(s[3].value="Â "),partsToDiv(s)),g=(E.className="date",h.appendChild(E),u.appendChild(h),document.createElement("td")),p=(g.className="details",document.createElement("div"));p.append(e.program),g.appendChild(p);const v=document.createElement("div");e.audience.forEach((e,a)=>{var n=document.createElement("span");n.append(e),0<a&&v.append(", "),v.appendChild(n)}),g.appendChild(v);s=document.createElement("div"),E=(s.append(e.language),g.appendChild(s),u.appendChild(g),document.createElement("td")),h=(E.className="location","Online"==e.type?((h=document.createElement("div")).append(e.type),E.appendChild(h),p=document.createElement("div"),"National"!=e.location&&(p.className="host"),p.append(e.location),E.appendChild(p)):((s=document.createElement("div")).append(e.location),E.appendChild(s),(g=document.createElement("div")).className="plus-online",g.append("+ Online"),E.appendChild(g)),document.createElement("td"));e.facilitator&&h.append(e.facilitator.map(e=>facilitators[e][0]).join(", ")),u.appendChild(E),u.appendChild(h),u.addEventListener("click",()=>window.open(e.href)),u.className="meeting",e.canceled&&u.classList.add("canceled"),a.appendChild(u)}}document.getElementById("results").replaceChildren(a)}function createOption(e,a){var n=document.createElement("option");return n.value=a||e,e&&n.append(e),n}function init(){const a=document.getElementById("program");["",...Object.keys(Object.fromEntries(meetings.map(e=>[e.program,1]))).filter(e=>"SMART Recovery"!=e&&"Standard"!=e).sort()].forEach(e=>a.appendChild(createOption(e)));const n=document.getElementById("audience"),t=(["",...Object.keys(Object.fromEntries(meetings.flatMap(e=>e.audience).map(e=>[e,1]))).sort().filter(e=>!audienceSynonyms[e])].forEach(e=>n.appendChild(createOption(e))),document.getElementById("language"));["",...Object.keys(Object.fromEntries(meetings.map(e=>[e.language,1]))).sort()].forEach(e=>t.appendChild(createOption(e))),t.value="English";var e=document.getElementById("facilitator"),i=Object.entries(facilitators).map(e=>[e[0],e[1][0]+(e[1][1]?` (${e[1][1]})`:"")]).sort((e,a)=>e[1].localeCompare(a[1]));const o=Object.groupBy(meetings.flatMap(e=>e.facilitator||[]),e=>e),d=document.createElement("optgroup"),r=(d.label="Multiple Upcoming Meetings",document.createElement("optgroup"));r.label="One Upcoming Meeting",i.forEach(e=>(1<o[e[0]]?.length?d:1==o[e[0]]?.length?r:null)?.appendChild(createOption(e[1],e[0]))),e.appendChild(createOption("")),e.appendChild(d),e.appendChild(r),a.addEventListener("change",render),n.addEventListener("change",render),t.addEventListener("change",render),e.addEventListener("change",render),document.getElementById("includehybrid").addEventListener("change",render)}init(),render();
