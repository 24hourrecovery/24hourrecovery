const us=Object.fromEntries(["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"].map(e=>[e,1])),ca=Object.fromEntries(["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Northwest Territories","Nova Scotia","Nunavut","Ontario","Prince Edward Island","Quebec","Saskatchewan","Yukon"].map(e=>[e,1])),audienceSynonyms=(meetings.find(e=>"https://meetings.smartrecovery.org/meetings/7360/"==e.href).audience=["Adults Welcome"],{LGBT:"LGBTQIA+","LGBTIQ+ only":"LGBTQIA+","Men only":"Men","Women Only":"Women","Female only":"Women"});function flag(e,a){let t=[e];"na"==e?(a=a.replace(/.*, /,""),t=us[a]?["us"]:ca[a]?["ca"]:["us","ca"]):"aus"==e?t=["au"]:"uk"==e&&(t=["gb"]);const n={us:"USA",ca:"Canada",uk:"UK",au:"Australia"},o=document.createElement("div");return o.className="flagwrapper",t.forEach(e=>{var a=document.createElement("img");a.src=`img/${e}.svg`,a.alt=n[e],a.height=32,a.width=32,a.className="flag",o.appendChild(a)}),o}function partsToDiv(e){const t=document.createElement("div");return e.forEach(e=>{var a;"literal"==e.type?t.append(e.value):((a=document.createElement("span")).className=e.type.replace(/([A-Z])/,e=>"-"+e.toLowerCase()),a.append(e.value),t.appendChild(a))}),t}function render(){var a=document.createElement("table");const t=document.createElement("tr");["Country","Time","Details","Location","Facilitator"].forEach(e=>{var a=document.createElement("th");a.append(e),t.appendChild(a)}),a.appendChild(t);var n=Intl.DateTimeFormat(void 0,{timeStyle:"short"}),o=Intl.DateTimeFormat(void 0,{weekday:"long",month:"long",day:"numeric"});const i=document.getElementById("program").value,d=document.getElementById("audience").value,c=document.getElementById("language").value,r=parseInt(document.getElementById("facilitator").value),l=document.getElementById("includehybrid").checked;var m=meetings.filter(e=>(!i||e.program==i||"4-Point Recovery"==i&&("SMART Recovery"==e.program||"Standard"==e.program))&&(!d||e.audience.map(e=>audienceSynonyms[e]||e).includes(d))&&(!c||e.language==c)&&(!r||(e.facilitator||[]).includes(r))&&(l||"Online"==e.type)).sort((e,a)=>e.time.localeCompare(a.time)),e=[],e=(i&&e.push("program="+encodeURIComponent(i)),d&&e.push("audience="+encodeURIComponent(d)),c&&e.push("language="+encodeURIComponent(c)),r&&e.push("facilitator="+encodeURIComponent(r)),l||e.push("includehybrid=0"),"?"+e.join("&"));history.replaceState(null,"",e);const s=Object.groupBy(meetings.flatMap(e=>e.facilitator||[]),e=>e),p=Object.groupBy(m.flatMap(e=>e.facilitator||[]),e=>e);for(let e of m){var u=new Date(e.time),h=new Date(u.getTime()+6e4*e.duration);if(!(h<new Date)){var g=document.createElement("tr"),f=document.createElement("td"),f=(f.appendChild(flag(e.dataSource,e.location)),g.appendChild(f),document.createElement("td")),E=document.createElement("div"),v=partsToDiv(n.formatToParts(u)),v=(v.className="time start",E.appendChild(v),partsToDiv(n.formatToParts(h))),h=(v.className="time end",E.append(" - "),E.appendChild(v),(60<=e.duration?Math.floor(e.duration/60+1e-8)+"h":"")+("0"+e.duration%60).slice(-2)),v=document.createElement("div"),h=(v.className="duration",v.append(h),E.appendChild(v),f.appendChild(E),o.formatToParts(u)),v=(" "==h[3].value&&(h[3].value="Â "),partsToDiv(h)),E=(v.className="date",f.appendChild(v),g.appendChild(f),document.createElement("td")),u=(E.className="details",document.createElement("div"));u.append(e.program),E.appendChild(u);const y=document.createElement("div");e.audience.forEach((e,a)=>{var t=document.createElement("span");t.append(e),0<a&&y.append(", "),y.appendChild(t)}),E.appendChild(y);h=document.createElement("div"),v=(h.append(e.language),E.appendChild(h),g.appendChild(E),document.createElement("td"));v.className="location","Online"==e.type?((f=document.createElement("div")).append(e.type),v.appendChild(f),u=document.createElement("div"),"National"!=e.location&&(u.className="host"),u.append(e.location),v.appendChild(u)):((h=document.createElement("div")).append(e.location),v.appendChild(h),(E=document.createElement("div")).className="plus-online",E.append("+ Online"),v.appendChild(E));const C=document.createElement("td");e.facilitator&&e.facilitator.forEach((a,e)=>{var t=facilitators[a][0],n=document.createElement("span"),t=(n.append(t),n.className="facilitator",0<e&&C.append(", "),s[a]?.length||0);const o=p[a]?.length||0;1<o?(n.classList.add("multiple-visible"),n.title="This facilitator runs other meetings, click to see them."):1<t&&(n.classList.add("multiple-filtered"),n.title="This facilitator runs other meetings but they are not currently displayed, click to see them."),n.title&&n.addEventListener("click",e=>{e.stopPropagation(),document.getElementById("facilitator").value=a,o<=1&&(document.getElementById("program").value="",document.getElementById("audience").value="",document.getElementById("language").value="",document.getElementById("includehybrid").checked=!0),render()}),C.appendChild(n)}),g.appendChild(v),g.appendChild(C),g.addEventListener("click",()=>window.open(e.href)),g.className="meeting",e.canceled&&g.classList.add("canceled"),a.appendChild(g)}}0==m.length&&(a.className="empty"),document.getElementById("results").replaceChildren(a)}function createOption(e,a){var t=document.createElement("option");return t.value=a||e,e&&t.append(e),t}function fixupHref(e,a){a=a.replace(/../g,(e,a)=>String.fromCharCode(parseInt(e,16)^parseInt("61d49d83dd87169964dccae130ebcb203a197d2abc08af0fc72ad345ef865b0e".slice(a,a+2),16)));e.href="mailto:"+a,e.append(a)}function init(){const a=document.getElementById("program");["",...Object.keys(Object.fromEntries(meetings.map(e=>[e.program,1]))).filter(e=>"SMART Recovery"!=e&&"Standard"!=e).sort()].forEach(e=>a.appendChild(createOption(e)));const t=document.getElementById("audience"),n=(["",...Object.keys(Object.fromEntries(meetings.flatMap(e=>e.audience).map(e=>[e,1]))).sort().filter(e=>!audienceSynonyms[e])].forEach(e=>t.appendChild(createOption(e))),document.getElementById("language"));["",...Object.keys(Object.fromEntries(meetings.map(e=>[e.language,1]))).sort()].forEach(e=>n.appendChild(createOption(e)));var e=document.getElementById("facilitator"),o=Object.entries(facilitators).map(e=>[e[0],e[1][0]+(e[1][1]?` (${e[1][1]})`:"")]).sort((e,a)=>e[1].localeCompare(a[1]));const i=Object.groupBy(meetings.flatMap(e=>e.facilitator||[]),e=>e),d=document.createElement("optgroup"),c=(d.label="Multiple Upcoming Meetings",document.createElement("optgroup"));c.label="One Upcoming Meeting",o.forEach(e=>(1<i[e[0]]?.length?d:1==i[e[0]]?.length?c:null)?.appendChild(createOption(e[1],e[0]))),e.appendChild(createOption("")),e.appendChild(d),e.appendChild(c),a.addEventListener("change",render),t.addEventListener("change",render),n.addEventListener("change",render),e.addEventListener("change",render),document.getElementById("includehybrid").addEventListener("change",render);o=document.location.search.match(/\bprogram=([^&]+)/);o&&(a.value=decodeURIComponent(o[1])),(o=document.location.search.match(/\baudience=([^&]+)/))&&(t.value=decodeURIComponent(o[1])),o=document.location.search.match(/\blanguage=([^&]+)/),n.value=o?o[1]:"English",(o=document.location.search.match(/\bfacilitator=(\d+)/))&&(e.value=o[1]),(o=document.location.search.match(/\bincludehybrid=(\d*)/))&&(document.getElementById("includehybrid").checked=!!parseInt(o[1]));for(let e of document.getElementsByTagName("a"))"mailto:"==e.href&&window.setTimeout(()=>fixupHref(e,"12b9fcf1a9f573fa0baaaf934982aa4e7a7e104bd564816ca847d9"),600);document.getElementById("controls").classList.remove("needs-init")}init(),render();
